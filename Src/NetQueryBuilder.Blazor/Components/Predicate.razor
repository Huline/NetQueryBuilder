@using System.Linq.Expressions
@using NetQueryBuilder.Conditions
@{
    var predicateExpression = Condition.Compile();
}
@switch (Condition.ComparaisonType)
{
    case ExpressionType.AndAlso:
    case ExpressionType.OrElse:
        <LogicalPredicate Condition="@Condition"
                          ParameterExpression="@ParameterExpression"
                          OnChange="@Change">
        </LogicalPredicate>
        break;
    case ExpressionType.Equal:
    case ExpressionType.NotEqual:
    case ExpressionType.GreaterThan:
    case ExpressionType.GreaterThanOrEqual:
    case ExpressionType.LessThan:
    case ExpressionType.LessThanOrEqual:
    case ExpressionType.Call:
    case ExpressionType.Not when predicateExpression is UnaryExpression unaryExpression && unaryExpression.Operand is MethodCallExpression:
        <RelationalPredicate PredicateExpression="@predicateExpression"
                             ParameterExpression="@ParameterExpression"
                             OnChange="@Change"
                             OnRemove="@Remove">
        </RelationalPredicate>
        break;
}

@code {

    [Parameter] public LogicalCondition Condition { get; set; }

    [Parameter] public ParameterExpression ParameterExpression { get; set; }

    [Parameter] public Action<Expression> OnChange { get; set; }

    [Parameter] public Action OnRemove { get; set; }

    private void Change(Expression expression)
    {
        OnChange(expression);
    }

    public void Remove()
    {
        if(OnRemove != null)
            OnRemove();
        StateHasChanged();
    }

}